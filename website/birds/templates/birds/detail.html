<!DOCTYPE html>
<html>
<head>
	<title>ques page</title>
</head>
<body>
	<div id="left"></div>
	<div id="center">
	<div id="life">Lives left: {{request.session.lives}} </div>
	<div  id="ques"><h2>{{ question.question_text }}</h2></div>

	{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<div  id="next" qid="{{ question.id }}"></div>
<div id="level " level="1" >
	
</div>
		<form id="myForm" action="" method="GET">
{% csrf_token %}
{% for choice in question.choice_set.all %}
			<div >
				<input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.id }}"> </input><label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label><br>
			</div>
{% endfor %}
		<input class="submitbtn" type="submit" value="submit"></input>
		</form>
	
<div id="response">
</div>
		<div id="box">
			<button class="btn">Restart</button>
			<button class="btn">Home</button>
			<button class="btn">Progress</button>
			<button class="btn">Exit</button>
		</div>
	</div>
	<div id="right"></div>
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.11.1.min.js">
</script>
<script language="JavaScript">
    $(document).ready(function() {
    	//e.getPreventDefault();
        $("#myForm").submit(function() { // catch the form's submit event
        	console.log($(this).serialize());	
            $.ajax({ // create an AJAX call...
                data: $(this).serialize(), // get the form data
                type: 'GET' ,
                url: "{% url 'birds:vote' question.id %}",
                success: function(response) { 
                	var qid=$('#next').attr('qid');
					var quesid=parseInt(qid)+1;
                	if(response.resp == "true")
                	{
                	//console.log(qid);
					//console.log(quesid);
						if(quesid<=2)
                		location.href="/birds/welcome/vocabulary/"+quesid+"/";
                		else
                		{
                			alert("level one completed");
                			
                			//location.href="/birds/welcome";
                		}

            		}
            		else if(response.resp=="false"){
            			location.href="/birds/welcome";
            		}
           			else 
           			{
           				console.log("at wrong answer");
                		//$('#outer-form').empty();
                    	$("#response").html("wrong answer ! <br><button id='again' class='btn'> try again. </button>"); 
                    	//$("#life").empty();
                    	//$("#life").html("Lives left:"+response.life+" ");
                    	//location.href="/birds/welcome/vocabulary/"+parseInt(qid)+"/";
            	
           			}
                },
                error: function(data) {
                $("#response").html("Something went wrong!");
            }
            });
            return false;
        });


    });


</script>

<script type="text/javascript">
document.getElementById("again").onclick= function() {
			var qid=$('#next').attr('qid');
			var quesid=parseInt(qid)+1;
			console.log($('#response').html());
			$("#response").empty();
			console.log($('#response').html());
			//location.href="/birds/welcome/vocabulary/"+parseInt(qid)+"/";
			// body...
		};
</script>
<style type="text/css">
	#left {
		float: left;
		display: inline-block;
		background-color: white;
		width: 30%;
		height: 600px;
	}
	#center {
		background: url(bg.png) no-repeat center center fixed; 
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
		color: #808080;
		background-color: rgb(200,200,200);
		font-family: comic sans MS;
		display: inline-block;
		background-color: white;
		width: 40%;
		height: 600px;
	
	}
	#right {
		float: right;
		display: inline-block;
		background-color: white;
		width: 30%;
		height: 600px;
	}
	#ques {
		color: #808080;
		text-align: center;
		margin-top: 60px;
	}
	#form {
		display: block;
		margin-left: 40%;
		margin-top: 80px;
	}
	.submitbtn {
        -webkit-border-radius: 10
        -moz-border-radius: 10;
  		border-radius: 30px;
  		font-family: Courier New;
  		color: #fcfcfc;
  		font-size: 15px;
  		background: #316e96; 
  		text-decoration: none;
  		margin-left: 40%;
  		margin-top: 110px;
  		padding: 10px 10px 10px 10px;
	}
	.btn {
        -webkit-border-radius: 10
        -moz-border-radius: 10;
  		border-radius: 30px;
  		font-family: Courier New;
  		color: #fcfcfc;
  		font-size: 15px;
  		background: #316e96;
  		padding: 10px 10px 10px 10px;
  		text-decoration: none;
  	}
	#box {
		position: relative;
		margin-top: 70px;
		padding-top: 20px;
		padding-bottom: 20px;
		padding-left: 50px;	
		margin-left: 20px;
	}
</style>
</body>
</html>